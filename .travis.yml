language: cpp

sudo: required
dist: trusty
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - qt5-default qttools5-dev-tools
      - g++-6 gcc-6
env: COMPILER=g++-6 CXX=g++-6 CC=gcc-6

before_script:
 - sudo add-apt-repository ppa:beineri/opt-qt562-trusty --yes
 - sudo apt-get update -qq
 - sudo apt-get install --yes qt56base
 - source /opt/qt56/bin/qt56-env.sh
 - git submodule init && git submodule update
 - qmake -v
 - mkdir ./legendsreplay/usr
 - mkdir ./legendsreplay/usr/bin

script:
 - cd qhttp
 - ./update-dependencies.sh
 - cd ..
 - qmake LegendsReplay.pro
 - make CXX=$COMPILER
 - cp ./src/legendsreplay ./legendsreplay/usr/bin
 - dpkg-deb --build legendsreplay
 